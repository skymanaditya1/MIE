@{
    ViewBag.Title = "Admin Portal";
}

<div class="container">
    <div class="jumbotron">
        <h1>Admin Portal</h1>
        <p class="lead">
            Add and Edit Grades, Courses, Resources
        </p>
    </div>
</div>

<a href="/Grades/Index" class="btn btn-info" role="button">Modify Grades</a>
<a href="/Courses/Index" class="btn btn-warning" role="button">Modify Courses</a>
<a href="/Admin/Approved" class="btn btn-success" role="button">Manage Educators</a>
<a href="/Admin/ManageSiteAdmins" class="btn btn-primary" role="button">Manage Site Admins</a>
<a href="/Admin/ResourcesUploaded" class="btn btn-info" role="button">View Uploaded Resources</a>
@*<a href="/Admin/Declined" class="btn btn-danger" role="button">Previously Denied</a>*@

<br />
<br />
<br />
<h2>Approvals Pending</h2>

<table class="table">
    <tr>
        <th>
            Name
        </th>
        <th>
            Email
        </th>
        <th>
            Zone
        </th>
        <th>
            School
        </th>
        <th>
            Action
        </th>
    </tr>

    @foreach (var user in ViewBag.Users)
    {
        <tr>
            <td>
                @user.Name
            </td>
            <td>
                @user.Email
            </td>
            <td>
                @user.Zone
            </td>
            <td>
                @user.School
            </td>
            <td id="@user.Id">
                <a class="btn btn-success" onclick="fillform('@user.Id',0)">Approve</a>
                <a class="btn btn-danger" onclick="fillform('@user.Id',1)">Decline</a>
            </td>
        </tr>
    }
</table>

@* By default, the user approval is set to NULL,
If the user is approved by the admin, the user approval is set to 0
If the user is declined by the admin, the user approval is set to 1 *@

<script type="text/javascript">
    function fillform(userId, approval) {
        $.ajax({
            type: 'GET',
            url: '@Url.Action("UpdateEducatorApprovals")',
            dataType: 'json',
            data: {
                userId: userId, approval: approval
            },
            success: function (data) {
                if (approval == 0)
                    $("#" + userId).html("<a class='btn btn-danger' onclick='fillform(\"" + userId + "\",1)'>Decline</a>");

                else if (approval == 1)
                    $("#" + userId).html("<a class='btn btn-success' onclick='fillform(\"" + userId + "\",0)'>Approve</a>");
            },
            error: function (e) {
                alert("Message : " + e.ToString());
            }
        });

        return false;
    }
</script>